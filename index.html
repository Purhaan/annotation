<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>üî¨ Binary Mask Annotator</title>
  <style>
    body{margin:0;font-family:Segoe UI;background:#f2f2f2}
    #wrapper{display:flex;height:100vh}
    #sidebar{background:#fff;width:280px;padding:20px;box-shadow:2px 0 5px rgba(0,0,0,.1)}
    #canvasArea{flex:1;display:flex;align-items:center;justify-content:center;background:#333}
    canvas{border:1px solid #555;max-width:90%;max-height:90%;cursor:crosshair;background:#000}
    button{width:100%;padding:12px;margin:8px 0;border:none;border-radius:4px;font-size:16px;cursor:pointer}
    .black{background:#000;color:#fff}
    .white{background:#fff;color:#000;border:1px solid #000}
    .active{outline:3px solid #4caf50}
    input[type=range]{width:100%}
  </style>
</head>
<body>
<div id="wrapper">
  <div id="sidebar">
    <input type="file" id="uploader" accept="image/*" style="display:none">
    <button onclick="document.getElementById('uploader').click()">üì§ Upload Image</button>

    <button id="btnBlack" class="black active" onclick="setColor('#000000',this)">Black (Background)</button>
    <button id="btnWhite" class="white"            onclick="setColor('#FFFFFF',this)">White (Mycorrhiza)</button>

    <label>Brush Size</label>
    <input type="range" id="brushSize" min="1" max="50" value="10">

    <button onclick="clearMask()">üóëÔ∏è Clear</button>
    <button onclick="downloadMask()">üíæ Save PNG</button>
  </div>

  <div id="canvasArea">
    <canvas id="cvs"></canvas>
  </div>
</div>

<script>
const cvs=document.getElementById('cvs'),ctx=cvs.getContext('2d');
ctx.imageSmoothingEnabled=false;
let img=new Image(),color='#000000',brush=10,drawing=false;

/* --- load image --- */
document.getElementById('uploader').addEventListener('change',e=>{
  const file=e.target.files[0];if(!file)return;
  const url=URL.createObjectURL(file);
  img.onload=()=>{
    cvs.width=img.width;cvs.height=img.height;
    ctx.fillStyle='#000000';ctx.fillRect(0,0,cvs.width,cvs.height);
    ctx.drawImage(img,0,0);
  };
  img.src=url;
});

/* --- drawing --- */
function setColor(c,btn){color=c;document.querySelectorAll('#sidebar button').forEach(b=>b.classList.remove('active'));btn.classList.add('active')}
document.getElementById('brushSize').addEventListener('input',e=>brush=+e.target.value);
cvs.addEventListener('mousedown',e=>{drawing=true;draw(e)});
cvs.addEventListener('mousemove',draw);
cvs.addEventListener('mouseup',()=>drawing=false);
function draw(e){if(!drawing)return;
  const rect=cvs.getBoundingClientRect();
  const x=(e.clientX-rect.left)*(cvs.width/rect.width);
  const y=(e.clientY-rect.top)*(cvs.height/rect.height);
  ctx.globalCompositeOperation='source-over';
  ctx.fillStyle=color;
  ctx.beginPath();ctx.arc(x,y,brush,0,2*Math.PI);ctx.fill();
}

/* --- clear / download --- */
function clearMask(){ctx.fillStyle='#000000';ctx.fillRect(0,0,cvs.width,cvs.height)}
function downloadMask(){
  const link=document.createElement('a');
  link.download='binary_mask.png';
  link.href=cvs.toDataURL('image/png');
  link.click();
}
</script>
</body>
</html>
